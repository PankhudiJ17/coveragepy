# Licensed under the Apache License: http://www.apache.org/licenses/LICENSE-2.0
# For details: https://github.com/coveragepy/coveragepy/blob/main/NOTICE.txt

name: "Tests"

on:
  push:
    branches:
      # - main
      # - nedbat/*
      - ppc_coverage
  pull_request:
  workflow_dispatch:

defaults:
  run:
    shell: bash

env:
  PIP_DISABLE_PIP_VERSION_CHECK: 1
  COVERAGE_IGOR_VERBOSE: 2
  FORCE_COLOR: 1    # Get colored pytest output
  HYPOTHESIS_PROFILE: ci

permissions:
  contents: read

concurrency:
  group: "${{ github.workflow }}-${{ github.ref }}"
  cancel-in-progress: true

jobs:
  changed:
    name: "Check changed files"
    runs-on: ubuntu-latest
    permissions:
      pull-requests: read
    outputs:
      run_tests: ${{ steps.filter.outputs.run_tests }}
    steps:
      - name: "Check out the repo"
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8
        with:
          persist-credentials: false

      - name: "Examine changed files"
        uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36
        id: filter
        with:
          filters: |
            run_tests:
              - "*.py"
              - "coverage/**.py"
              - "tests/**.py"
              - "**.h"
              - "**.c"
              - ".github/workflows/testsuite.yml"
              - "tox.ini"
              - "requirements/*.pip"
              - "tests/gold/**"

  tests:
    name: "${{ matrix.python-version }} on ${{ matrix.os }}"
    runs-on: ${{ matrix.runs-on || format('{0}-{1}', matrix.os, matrix.os-version) }}
    timeout-minutes: 10

    needs: changed
    if:
      needs.changed.outputs.run_tests == 'true'
      && !contains(github.ref, '-notests')

    env:
      TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

    strategy:
      fail-fast: false
      matrix:
        os:
          - ubuntu
          - macos
          - windows
        os-version:
          - latest
        python-version:
          - "3.10"
          - "3.11"
          - "3.12"
          - "3.13"
          - "3.13t"
          - "3.14"
          - "3.14t"
          - "3.15"
          - "3.15t"
          - "pypy-3.10"
          - "pypy-3.11"

        # ppc64le self-hosted runner
        include:
          - os: linux
            os-version: self-hosted
            python-version: "3.12"
            arch: ppc64le
            runs-on: [self-hosted, linux, ppc64le]

    steps:
      - name: "Check out the repo"
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8
        with:
          persist-credentials: false

      # GitHub-hosted runners
      - name: "Set up Python (GitHub-hosted)"
        if: ${{ matrix.arch != 'ppc64le' }}
        uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548
        with:
          python-version: "${{ matrix.python-version }}"
          allow-prereleases: true

      # Self-hosted ppc64le
      - name: "Install Python (ppc64le)"
        if: ${{ matrix.arch == 'ppc64le' }}
        run: |
          set -xe

          sudo apt-get update
          sudo apt-get install -y \
            python${{ matrix.python-version }} \
            python${{ matrix.python-version }}-venv \
            python${{ matrix.python-version }}-dev

          # Make this Python available as `python`
          sudo update-alternatives --install /usr/bin/python python /usr/bin/python${{ matrix.python-version }} 1

          python -VV
          python -m ensurepip --upgrade
          python -m pip install --upgrade pip

      - name: "Show environment"
        run: |
          set -xe
          python -VV
          python -m site
          env | sort
          chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
          ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
          whoami

      - name: "Install dependencies"
        run: |
          set -xe
          python -m pip install -r requirements/tox.pip

      - name: "Run tox for ${{ matrix.python-version }}"
        run: |
          python -m tox -- -rfsEX

      - name: "Retry tox for ${{ matrix.python-version }}"
        if: failure()
        run: |
          python -m tox -- -rfsEX --lf -vvvvv && exit 1

  success:
    name: Tests successful
    needs:
      - tests
    runs-on: ubuntu-latest
    steps:
      - name: Decide whether the needed jobs succeeded or failed
        uses: re-actors/alls-green@05ac9388f0aebcb5727afa17fcccfecd6f8ec5fe
        with:
          jobs: ${{ toJSON(needs) }}






# name: Tests

# on:
#   push:
#     branches:
#       - ppc_coverage
#   pull_request:
#   workflow_dispatch:

# defaults:
#   run:
#     shell: bash

# env:
#   PIP_DISABLE_PIP_VERSION_CHECK: 1
#   COVERAGE_IGOR_VERBOSE: 2
#   FORCE_COLOR: 1
#   HYPOTHESIS_PROFILE: ci

# permissions:
#   contents: read

# concurrency:
#   group: "${{ github.workflow }}-${{ github.ref }}"
#   cancel-in-progress: true

# jobs:
#   changed:
#     name: Check changed files
#     runs-on: ubuntu-latest
#     permissions:
#       pull-requests: read
#     outputs:
#       run_tests: ${{ steps.filter.outputs.run_tests }}
#     steps:
#       - uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8
#         with:
#           persist-credentials: false

#       - uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36
#         id: filter
#         with:
#           filters: |
#             run_tests:
#               - "*.py"
#               - "coverage/**.py"
#               - "tests/**.py"
#               - "**.h"
#               - "**.c"
#               - ".github/workflows/testsuite.yml"
#               - "tox.ini"
#               - "requirements/*.pip"
#               - "tests/gold/**"

#   tests:
#     name: >
#       Tests | ${{ matrix.python-version }} |
#       ${{ matrix.os }}-${{ matrix.os-version }}
#       ${{ matrix.arch && matrix.arch == 'ppc64le' && '(ppc64le)' || '' }}

#     needs: changed
#     if: >
#       needs.changed.outputs.run_tests == 'true'
#       && !contains(github.ref, '-notests')

#     timeout-minutes: 10

#     runs-on: >
#       ${{ matrix.arch && matrix.arch == 'ppc64le'
#           && 'self-hosted'
#           || format('{0}-{1}', matrix.os, matrix.os-version) }}

#     env:
#       TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

#     strategy:
#       fail-fast: false
#       matrix:
#         os:
#           - ubuntu
#           - macos
#           - windows
#         os-version:
#           - latest
#         python-version:
#           - "3.10"
#           - "3.11"
#           - "3.12"
#           - "3.13"
#           - "3.13t"
#           - "3.14"
#           - "3.14t"
#           - "3.15"
#           - "3.15t"
#           - "pypy-3.10"
#           - "pypy-3.11"

#         include:
#           # PPC64LE (self-hosted only)
#           #- os: ubuntu
#           #  os-version: latest
#           - python-version: "3.10"
#             arch: ppc64le
#           #- os: ubuntu
#           #  os-version: latest
#           - python-version: "3.11"
#             arch: ppc64le
#           # - os: ubuntu
#           #   os-version: latest
#           - python-version: "3.12"
#             arch: ppc64le
#           #- os: ubuntu
#           #  os-version: latest
#           - python-version: "3.13"
#             arch: ppc64le
#           #- os: ubuntu
#           #  os-version: latest
#           - python-version: "3.14"
#             arch: ppc64le
#           #- os: ubuntu
#           #  os-version: latest
#           - python-version: "3.15"
#             arch: ppc64le

#     steps:
#       - uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8
#         with:
#           persist-credentials: false

#       # GitHub-hosted runners
#       - name: Set up Python
#         if: ${{ !matrix.arch }}
#         uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548
#         with:
#           python-version: "${{ matrix.python-version }}"
#           allow-prereleases: true

#       # PPC64LE self-hosted
#       - name: Install Python (ppc64le)
#         if: ${{ matrix.arch == 'ppc64le' }}
#         run: |
#           sudo apt update
#           sudo apt install software-properties-common -y
#           sudo add-apt-repository ppa:deadsnakes/ppa -y
#           sudo apt update
#           sudo apt install python${{ matrix.python-version }} \
#                            python${{ matrix.python-version }}-venv \
#                            python${{ matrix.python-version }}-dev -y
#           python${{ matrix.python-version }} -m venv myvenv
#           source myvenv/bin/activate
#           python -m pip install --upgrade pip

#       - name: Show environment
#         run: |
#           set -xe
#           python -VV
#           python -m site
#           env | sort
#           chmod u-w $(python - <<'EOF'
#           import site; print(site.getsitepackages()[0])
#           EOF
#           ) || echo "Couldn't lock down site-packages"
#           whoami

#       - name: Install dependencies
#         run: |
#           python -m pip install -r requirements/tox.pip

#       - name: Run tox
#         run: |
#           python -m tox -- -rfsEX

#       - name: Retry tox
#         if: failure()
#         run: |
#           python -m tox -- -rfsEX --lf -vvvvv && exit 1

#   success:
#     name: Tests successful
#     needs: tests
#     runs-on: ubuntu-latest
#     steps:
#       - uses: re-actors/alls-green@05ac9388f0aebcb5727afa17fcccfecd6f8ec5fe
#         with:
#           jobs: ${{ toJSON(needs) }}









# # # Licensed under the Apache License: http://www.apache.org/licenses/LICENSE-2.0
# # # For details: https://github.com/coveragepy/coveragepy/blob/main/NOTICE.txt

# # name: "Tests"

# # on:
# #   push:
# #     branches:
# #       #- main
# #       #- nedbat/*
# #       - ppc_coverage
# #   pull_request:
# #   workflow_dispatch:

# # defaults:
# #   run:
# #     shell: bash

# # env:
# #   PIP_DISABLE_PIP_VERSION_CHECK: 1
# #   COVERAGE_IGOR_VERBOSE: 2
# #   FORCE_COLOR: 1    # Get colored pytest output
# #   HYPOTHESIS_PROFILE: ci

# # permissions:
# #   contents: read

# # concurrency:
# #   group: "${{ github.workflow }}-${{ github.ref }}"
# #   cancel-in-progress: true

# # jobs:
# #   changed:
# #     name: "Check changed files"
# #     runs-on: ubuntu-latest
# #     permissions:
# #       pull-requests: read   # Needed for this check to run on pull requests
# #     outputs:
# #       run_tests: ${{ steps.filter.outputs.run_tests }}
# #     steps:
# #       - name: "Check out the repo"
# #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# #         with:
# #           persist-credentials: false

# #       - name: "Examine changed files"
# #         uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36 # v3.0.2
# #         id: filter
# #         with:
# #           filters: |
# #             run_tests:
# #               - "*.py"
# #               - "coverage/**.py"
# #               - "tests/**.py"
# #               - "**.h"
# #               - "**.c"
# #               - ".github/workflows/testsuite.yml"
# #               - "tox.ini"
# #               - "requirements/*.pip"
# #               - "tests/gold/**"

# #   tests:
# #     name: >
# #       ${{ matrix.os }}-${{ matrix.os-version }}
# #       ${{ matrix.arch == 'ppc64le' && '(ppc64le)' || '' }}
# #     runs-on: "${{ matrix.arch == 'ppc64le'
# #       && 'self-hosted'
# #       || format('{0}-{1}', matrix.os, matrix.os-version) }}" 
# #     #"${{ matrix.os }}-${{ matrix.os-version }}"
# #     timeout-minutes: 10

# #     # Don't run tests if the branch name includes "-notests".
# #     # Only run tests if files that affect tests have changed.
# #     needs: changed
# #     if:
# #       needs.changed.outputs.run_tests == 'true'
# #       && !contains(github.ref, '-notests')

# #     env:
# #       TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

# #     strategy:
# #       matrix:
# #         os:
# #           - ubuntu
# #           - macos
# #           - windows
# #         os-version:
# #           - latest
# #         python-version:
# #           # When changing this list, be sure to check the [gh] list in
# #           # tox.ini so that tox will run properly. PYVERSIONS
# #           # Available versions:
# #           # https://github.com/actions/python-versions/blob/main/versions-manifest.json
# #           # https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#available-versions-of-python-and-pypy
# #           - "3.10"
# #           - "3.11"
# #           - "3.12"
# #           - "3.13"
# #           - "3.13t"
# #           - "3.14"
# #           - "3.14t"
# #           - "3.15"
# #           - "3.15t"
# #           - "pypy-3.10"
# #           - "pypy-3.11"

# #         arch: 
# #           - ppc64le  
        
# #         include:
# #       # PPC64LE only â€“ no duplication of x64 entries
# #           - os: ubuntu
# #             os-version: latest
# #             python-version: "3.10"
# #             arch: ppc64le
# #           - os: ubuntu
# #             os-version: latest
# #             python-version: "3.11"
# #             arch: ppc64le
# #           - os: ubuntu
# #             os-version: latest
# #             python-version: "3.12"
# #             arch: ppc64le
# #           - os: ubuntu
# #             os-version: latest
# #             python-version: "3.13"
# #             arch: ppc64le
# #           - os: ubuntu
# #             os-version: latest
# #             python-version: "3.14"
# #             arch: ppc64le
# #           - os: ubuntu
# #             os-version: latest
# #             python-version: "3.15"
# #             arch: ppc64le  
# #         #
# #         # If we need to exclude any combinations, do it like this:
# #         #  exclude:
# #         #    # Windows pypy 3.9 and 3.10 get stuck with PyPy 7.3.15.
# #         #    - os: windows
# #         #      python-version: "pypy-3.10"
# #         #
# #         # If we need to tweak the os version we can do it with an include like
# #         # this:
# #         #  include:
# #         #    - python-version: "3.12"
# #         #      os: "macos"
# #         #      os-version: "15"

# #       fail-fast: false

# #     steps:
# #       - name: "Check out the repo"
# #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# #         with:
# #           persist-credentials: false
      
# #       - if: ${{ matrix.arch != 'ppc64le' }}
# #         name: "Set up Python"
# #         uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# #         with:
# #           python-version: "${{ matrix.python-version }}"
# #           allow-prereleases: true
# #           # At a certain point, installing dependencies failed on pypy 3.9 and
# #           # 3.10 on Windows.  Commenting out the cache here fixed it.  Someday
# #           # try using the cache again.
# #           #cache: pip
# #           #cache-dependency-path: 'requirements/*.pip'
      
# #       - if: ${{ matrix.arch == 'ppc64le' }}
# #         name: "Install dependencies"
# #         run: |
# #           sudo apt update
# #           sudo apt install software-properties-common -y
# #           sudo add-apt-repository ppa:deadsnakes/ppa -y
# #           sudo apt update
# #           sudo apt install python${{ matrix.python-version }} python${{ matrix.python-version }}-venv python${{ matrix.python-version }}-dev -y
# #           python${{ matrix.python-version }} -m venv myvenv
# #           source myvenv/bin/activate
# #           python${{ matrix.python-version }} -m pip install --upgrade pip
# #           python${{ matrix.python-version }} -m pip install cibuildwheel

# #       - name: "Show environment"
# #         run: |
# #           set -xe
# #           python -VV
# #           python -m site
# #           # For extreme debugging:
# #           # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# #           env | sort
# #           # Ideally, the system Python wouldn't have writable sitepackages so
# #           # try to make it not writable.  We can't always always change the
# #           # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# #           chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# #           ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# #           whoami

# #       - name: "Install dependencies"
# #         run: |
# #           set -xe
# #           python -m pip install -r requirements/tox.pip

# #       - name: "Run tox for ${{ matrix.python-version }}"
# #         run: |
# #           python -m tox -- -rfsEX

# #       - name: "Retry tox for ${{ matrix.python-version }}"
# #         if: failure()
# #         run: |
# #           # `exit 1` makes sure that the job remains red with flaky runs
# #           python -m tox -- -rfsEX --lf -vvvvv && exit 1

# #   # This job aggregates test results. It's the required check for branch protection.
# #   # https://github.com/marketplace/actions/alls-green#why
# #   # https://github.com/orgs/community/discussions/33579
# #   success:
# #     name: Tests successful
# #     needs:
# #       - tests
# #     runs-on: ubuntu-latest
# #     steps:
# #       - name: Decide whether the needed jobs succeeded or failed
# #         uses: re-actors/alls-green@05ac9388f0aebcb5727afa17fcccfecd6f8ec5fe # v1.2.2
# #         with:
# #           jobs: ${{ toJSON(needs) }}



# # # Licensed under the Apache License: http://www.apache.org/licenses/LICENSE-2.0
# # # For details: https://github.com/coveragepy/coveragepy/blob/main/NOTICE.txt

# # # # name: "Tests"

# # # # on:
# # # #   push:
# # # #     branches:
# # # #       # - main
# # # #       # - nedbat/*
# # # #       - ppc_coverage
# # # #   pull_request:
# # # #   workflow_dispatch:

# # # # defaults:
# # # #   run:
# # # #     shell: bash

# # # # env:
# # # #   PIP_DISABLE_PIP_VERSION_CHECK: 1
# # # #   COVERAGE_IGOR_VERBOSE: 2
# # # #   FORCE_COLOR: 1    # Get colored pytest output
# # # #   HYPOTHESIS_PROFILE: ci

# # # # permissions:
# # # #   contents: read

# # # # concurrency:
# # # #   group: "${{ github.workflow }}-${{ github.ref }}"
# # # #   cancel-in-progress: true

# # # # jobs:
# # # #   changed:
# # # #     name: "Check changed files"
# # # #     runs-on: ubuntu-latest
# # # #     permissions:
# # # #       pull-requests: read   # Needed for this check to run on pull requests
# # # #     outputs:
# # # #       run_tests: ${{ steps.filter.outputs.run_tests }}
# # # #     steps:
# # # #       - name: "Check out the repo"
# # # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # # #         with:
# # # #           persist-credentials: false

# # # #       - name: "Examine changed files"
# # # #         uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36 # v3.0.2
# # # #         id: filter
# # # #         with:
# # # #           filters: |
# # # #             run_tests:
# # # #               - "*.py"
# # # #               - "coverage/**.py"
# # # #               - "tests/**.py"
# # # #               - "**.h"
# # # #               - "**.c"
# # # #               - ".github/workflows/testsuite.yml"
# # # #               - "tox.ini"
# # # #               - "requirements/*.pip"
# # # #               - "tests/gold/**"

# # # #   tests:
# # # #     name: "${{ matrix.python-version }} on ${{ matrix.os }} on ${{ matrix.arch }}"
# # # #     # runs-on: "${{ 
# # # #     #   matrix.arch == 'ppc64le' && fromJSON('["self-hosted", "linux", "ppc64le"]') || fromJSON(format('["{0}-{1}"]', matrix.os, matrix.os-version || 'latest'))}} #${{ matrix.os }}-${{ matrix.os-version }}"
# # # #     # runs-on: ${{
# # # #     #   matrix.arch == 'ppc64le'
# # # #     #   && fromJSON('["self-hosted", "linux", "ppc64le"]')
# # # #     #   || fromJSON(format('["{0}-{1}"]', matrix.os, matrix.os-version || 'latest'))
# # # #     # }}
# # # #     runs-on: ${{ matrix.arch == 'ppc64le' && fromJSON('["self-hosted"]') || fromJSON(format('["{0}-{1}"]', matrix.os, matrix.os-version || 'latest'))}}  #"${{ matrix.os }}-${{ matrix.os-version || 'latest' }}"
# # # #     timeout-minutes: 10

# # # #     # Don't run tests if the branch name includes "-notests".
# # # #     # Only run tests if files that affect tests have changed.
# # # #     needs: changed
# # # #     if:
# # # #       needs.changed.outputs.run_tests == 'true'
# # # #       && !contains(github.ref, '-notests')

# # # #     env:
# # # #       TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

# # # #     strategy:
# # # #       matrix:
# # # #         os:
# # # #           - ubuntu
# # # #           - macos
# # # #           - windows
# # # #         os-version:
# # # #           - latest
# # # #         arch:
# # # #           - ppc64le  
# # # #         python-version:
# # # #           # When changing this list, be sure to check the [gh] list in
# # # #           # tox.ini so that tox will run properly. PYVERSIONS
# # # #           # Available versions:
# # # #           # https://github.com/actions/python-versions/blob/main/versions-manifest.json
# # # #           # https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#available-versions-of-python-and-pypy
# # # #           - "3.10"
# # # #           - "3.11"
# # # #           - "3.12"
# # # #           - "3.13"
# # # #           - "3.13t"
# # # #           - "3.14"
# # # #           - "3.14t"
# # # #           - "3.15"
# # # #           - "3.15t"
# # # #           - "pypy-3.10"
# # # #           - "pypy-3.11"
# # # #         #
# # # #         # If we need to exclude any combinations, do it like this:
# # # #         #  exclude:
# # # #         #    # Windows pypy 3.9 and 3.10 get stuck with PyPy 7.3.15.
# # # #         #    - os: windows
# # # #         #      python-version: "pypy-3.10"
# # # #         #
# # # #         # If we need to tweak the os version we can do it with an include like
# # # #         # this:
# # # #         #  include:
# # # #         #    - python-version: "3.12"
# # # #         #      os: "macos"
# # # #         #      os-version: "15"

# # # #       fail-fast: false

# # # #     steps:
# # # #       - name: "Check out the repo"
# # # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # # #         with:
# # # #           persist-credentials: false

# # # #       - if: ${{ matrix.arch != 'ppc64le' }}
# # # #         name: "Set up Python"
# # # #         uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# # # #         with:
# # # #           python-version: "${{ matrix.python-version }}"
# # # #           allow-prereleases: true

# # # #       - if: ${{ matrix.arch == 'ppc64le' }}
# # # #         name: "Install dependencies"
# # # #         run: |
# # # #           sudo apt update
# # # #           sudo apt install software-properties-common -y
# # # #           sudo add-apt-repository ppa:deadsnakes/ppa -y
# # # #           sudo apt update
# # # #           sudo apt install python${{ matrix.python-version }} python${{ matrix.python-version }}-venv python${{ matrix.python-version }}-dev -y
# # # #           python${{ matrix.python-version }} -m venv myvenv
# # # #           source myvenv/bin/activate
# # # #           python${{ matrix.python-version }} -m pip install --upgrade pip
# # # #           python${{ matrix.python-version }} -m pip install cibuildwheel   


# # # #           # At a certain point, installing dependencies failed on pypy 3.9 and
# # # #           # 3.10 on Windows.  Commenting out the cache here fixed it.  Someday
# # # #           # try using the cache again.
# # # #           #cache: pip
# # # #           #cache-dependency-path: 'requirements/*.pip'

# # # #       - name: "Show environment"
# # # #         run: |
# # # #           set -xe
# # # #           python -VV
# # # #           python -m site
# # # #           # For extreme debugging:
# # # #           # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# # # #           env | sort
# # # #           # Ideally, the system Python wouldn't have writable sitepackages so
# # # #           # try to make it not writable.  We can't always always change the
# # # #           # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# # # #           chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# # # #           ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# # # #           whoami

# # # #       - name: "Install dependencies"
# # # #         run: |
# # # #           set -xe
# # # #           python -m pip install -r requirements/tox.pip

# # # #       - name: "Run tox for ${{ matrix.python-version }}"
# # # #         run: |
# # # #           python -m tox -- -rfsEX

# # # #       - name: "Retry tox for ${{ matrix.python-version }}"
# # # #         if: failure()
# # # #         run: |
# # # #           # `exit 1` makes sure that the job remains red with flaky runs
# # # #           python -m tox -- -rfsEX --lf -vvvvv && exit 1

# # # #   # This job aggregates test results. It's the required check for branch protection.
# # # #   # https://github.com/marketplace/actions/alls-green#why
# # # #   # https://github.com/orgs/community/discussions/33579
  
# # # #   # tests-ppc64le: 
# # # #   #   name: Tests on ppc64le (self-hosted) ${{ matrix.python-version }}
# # # #   #   runs-on: self-hosted
# # # #   #   timeout-minutes: 10

# # # #   #   # Don't run tests if the branch name includes "-notests".
# # # #   #   # Only run tests if files that affect tests have changed.
# # # #   #   needs: changed
# # # #   #   if:
# # # #   #     needs.changed.outputs.run_tests == 'true'
# # # #   #     && !contains(github.ref, '-notests')

# # # #   #   env:
# # # #   #     TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

# # # #   #   strategy:
# # # #   #     matrix:
        
# # # #   #       python-version:
# # # #   #         # When changing this list, be sure to check the [gh] list in
# # # #   #         # tox.ini so that tox will run properly. PYVERSIONS
# # # #   #         # Available versions:
# # # #   #         # https://github.com/actions/python-versions/blob/main/versions-manifest.json
# # # #   #         # https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#available-versions-of-python-and-pypy
# # # #   #         - "3.10"
# # # #   #         - "3.11"
# # # #   #         - "3.12"
# # # #   #         - "3.13"
# # # #   #         - "3.14"
# # # #   #         - "3.15"
# # # #   #       #
# # # #   #       # If we need to exclude any combinations, do it like this:
# # # #   #       #  exclude:
# # # #   #       #    # Windows pypy 3.9 and 3.10 get stuck with PyPy 7.3.15.
# # # #   #       #    - os: windows
# # # #   #       #      python-version: "pypy-3.10"
# # # #   #       #
# # # #   #       # If we need to tweak the os version we can do it with an include like
# # # #   #       # this:
# # # #   #       #  include:
# # # #   #       #    - python-version: "3.12"
# # # #   #       #      os: "macos"
# # # #   #       #      os-version: "15"

# # # #   #     fail-fast: false

# # # #   #   steps:
# # # #   #     - name: "Check out the repo"
# # # #   #       uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # # #   #       with:
# # # #   #         persist-credentials: false

# # # #   #     - name: "Install dependencies"
# # # #   #       run: |
# # # #   #         sudo apt update
# # # #   #         sudo apt install software-properties-common -y
# # # #   #         sudo add-apt-repository ppa:deadsnakes/ppa -y
# # # #   #         sudo apt update
# # # #   #         sudo apt install python${{ matrix.python-version }} python${{ matrix.python-version }}-venv python${{ matrix.python-version }}-dev -y
# # # #   #         python${{ matrix.python-version }} -m venv myvenv
# # # #   #         source myvenv/bin/activate
# # # #   #         python${{ matrix.python-version }} -m pip install --upgrade pip
# # # #   #         python${{ matrix.python-version }} -m pip install cibuildwheel
         
# # # #   #     - name: "Show environment"
# # # #   #       run: |
# # # #   #         set -xe
# # # #   #         python -VV
# # # #   #         python -m site
# # # #   #         # For extreme debugging:
# # # #   #         # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# # # #   #         env | sort
# # # #   #         # Ideally, the system Python wouldn't have writable sitepackages so
# # # #   #         # try to make it not writable.  We can't always always change the
# # # #   #         # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# # # #   #         chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# # # #   #         ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# # # #   #         whoami

# # # #   #     - name: "Install dependencies"
# # # #   #       run: |
# # # #   #         set -xe
# # # #   #         python -m pip install -r requirements/tox.pip

# # # #   #     - name: "Run tox for ${{ matrix.python-version }}"
# # # #   #       run: |
# # # #   #         python -m tox -- -rfsEX

# # # #   #     - name: "Retry tox for ${{ matrix.python-version }}"
# # # #   #       if: failure()
# # # #   #       run: |
# # # #   #         # `exit 1` makes sure that the job remains red with flaky runs
# # # #   #         python -m tox -- -rfsEX --lf -vvvvv && exit 1

# # # #   success:
# # # #     name: Tests successful
# # # #     needs:
# # # #       - tests
# # # #       # - tests-ppc64le
# # # #     runs-on: ubuntu-latest
# # # #     steps:
# # # #       - name: Decide whether the needed jobs succeeded or failed
# # # #         uses: re-actors/alls-green@05ac9388f0aebcb5727afa17fcccfecd6f8ec5fe # v1.2.2
# # # #         with:
# # #           jobs: ${{ toJSON(needs) }}














# # ##self hosted runner - all tests passed###

# # # # Licensed under the Apache License: http://www.apache.org/licenses/LICENSE-2.0
# # # # For details: https://github.com/coveragepy/coveragepy/blob/main/NOTICE.txt

# # # name: "Tests"

# # # on:
# # #   push:
# # #     branches:
# # #       #- main
# # #       #- nedbat/*
# # #       - ppc_coverage
# # #   pull_request:
# # #   workflow_dispatch:

# # # defaults:
# # #   run:
# # #     shell: bash

# # # env:
# # #   PIP_DISABLE_PIP_VERSION_CHECK: 1
# # #   COVERAGE_IGOR_VERBOSE: 2
# # #   FORCE_COLOR: 1    # Get colored pytest output
# # #   HYPOTHESIS_PROFILE: ci

# # # permissions:
# # #   contents: read

# # # concurrency:
# # #   group: "${{ github.workflow }}-${{ github.ref }}"
# # #   cancel-in-progress: true

# # # jobs:
# # #   changed:
# # #     name: "Check changed files"
# # #     runs-on: ubuntu-latest
# # #     permissions:
# # #       pull-requests: read   # Needed for this check to run on pull requests
# # #     outputs:
# # #       run_tests: ${{ steps.filter.outputs.run_tests }}
# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false

# # #       - name: "Examine changed files"
# # #         uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36 # v3.0.2
# # #         id: filter
# # #         with:
# # #           filters: |
# # #             run_tests:
# # #               - "*.py"
# # #               - "coverage/**.py"
# # #               - "tests/**.py"
# # #               - "**.h"
# # #               - "**.c"
# # #               - ".github/workflows/testsuite.yml"
# # #               - "tox.ini"
# # #               - "requirements/*.pip"
# # #               - "tests/gold/**"

# # #   tests:
# # #     name: "${{ matrix.python-version }} on ${{ matrix.os }}"
# # #     runs-on: "${{ matrix.os }}-${{ matrix.os-version }}"
# # #     timeout-minutes: 10

# # #     # Don't run tests if the branch name includes "-notests".
# # #     # Only run tests if files that affect tests have changed.
# # #     needs: changed
# # #     if:
# # #       needs.changed.outputs.run_tests == 'true'
# # #       && !contains(github.ref, '-notests')

# # #     env:
# # #       TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

# # #     strategy:
# # #       matrix:
# # #         os:
# # #           - ubuntu
# # #           - macos
# # #           - windows
# # #         os-version:
# # #           - latest 
# # #         python-version:
# # #           # When changing this list, be sure to check the [gh] list in
# # #           # tox.ini so that tox will run properly. PYVERSIONS
# # #           # Available versions:
# # #           # https://github.com/actions/python-versions/blob/main/versions-manifest.json
# # #           # https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#available-versions-of-python-and-pypy
# # #           - "3.10"
# # #           - "3.11"
# # #           - "3.12"
# # #           - "3.13"
# # #           - "3.13t"
# # #           - "3.14"
# # #           - "3.14t"
# # #           - "3.15"
# # #           - "3.15t"
# # #           - "pypy-3.10"
# # #           - "pypy-3.11"
# # #         #
# # #         # If we need to exclude any combinations, do it like this:
# # #         #  exclude:
# # #         #    # Windows pypy 3.9 and 3.10 get stuck with PyPy 7.3.15.
# # #         #    - os: windows
# # #         #      python-version: "pypy-3.10"
# # #         #
# # #         # If we need to tweak the os version we can do it with an include like
# # #         # this:
# # #         #  include:
# # #         #    - python-version: "3.12"
# # #         #      os: "macos"
# # #         #      os-version: "15"

# # #       fail-fast: false

# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false

# # #       - name: "Set up Python"
# # #         uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# # #         with:
# # #           python-version: "${{ matrix.python-version }}"
# # #           allow-prereleases: true

# # # #       - if: ${{ matrix.arch != 'ppc64le' }}
# # # # #         name: "Install Python"
# # # # #         uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# # # # #         with:
# # # # #           python-version: "${{ matrix.cipy }}"
# # # # #           cache: pip
# # # # #           cache-dependency-path: 'requirements/*.pip'

# # # # #       - if: ${{ matrix.arch == 'ppc64le' }}
# # # # #         name: "Install dependencies"
# # # # #         run: |
# # # # #           sudo apt update
# # # # #           sudo apt install -y python3 python3-pip python3-dev python3-venv
# # # # #           python3 -m pip install --upgrade pip
# # # # #           python3 -m pip install cibuildwheel
# # #           # At a certain point, installing dependencies failed on pypy 3.9 and
# # #           # 3.10 on Windows.  Commenting out the cache here fixed it.  Someday
# # #           # try using the cache again.
# # #           #cache: pip
# # #           #cache-dependency-path: 'requirements/*.pip'

# # #       - name: "Show environment"
# # #         run: |
# # #           set -xe
# # #           python -VV
# # #           python -m site
# # #           # For extreme debugging:
# # #           # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# # #           env | sort
# # #           # Ideally, the system Python wouldn't have writable sitepackages so
# # #           # try to make it not writable.  We can't always always change the
# # #           # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# # #           chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# # #           ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# # #           whoami

# # #       - name: "Install dependencies"
# # #         run: |
# # #           set -xe
# # #           python -m pip install -r requirements/tox.pip

# # #       - name: "Run tox for ${{ matrix.python-version }}"
# # #         run: |
# # #           python -m tox -- -rfsEX

# # #       - name: "Retry tox for ${{ matrix.python-version }}"
# # #         if: failure()
# # #         run: |
# # #           # `exit 1` makes sure that the job remains red with flaky runs
# # #           python -m tox -- -rfsEX --lf -vvvvv && exit 1

# # #   tests-ppc64le:
# # #     name: "Tests on ppc64le (self-hosted) ${{ matrix.python-version }}"
# # #     runs-on: self-hosted
# # #     timeout-minutes: 10

# # #     needs: changed

# # #     env:
# # #       TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

# # #     strategy:
# # #       matrix:
# # #         python-version:
# # #           - "3.10"
# # #           - "3.11"
# # #           - "3.12"
# # #           - "3.13"
# # #        #   - "3.13t"
# # #           - "3.14"
# # #        #   - "3.14t"
# # #        #   - "3.15"
# # #        #  - "3.15t"
# # #        #   - "pypy-3.10"
# # #        #   - "pypy-3.11"
      
# # #         arch:
# # #           - ppc64le 
# # #       fail-fast: false 
# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false

      
# # #       - if: ${{ matrix.arch == 'ppc64le' }}
# # #         name: "Install dependencies"
# # #         run: |
# # #           sudo apt update
# # #           sudo apt install software-properties-common -y
# # #           sudo add-apt-repository ppa:deadsnakes/ppa -y
# # #           sudo apt update
# # #           sudo apt install python${{ matrix.python-version }} python${{ matrix.python-version }}-venv python${{ matrix.python-version }}-dev -y
          
# # #           python${{ matrix.python-version }} -m venv myvenv
# # #           source myvenv/bin/activate
# # #           python${{ matrix.python-version }} -m pip install --upgrade pip
# # #           python${{ matrix.python-version }} -m pip install cibuildwheel    

# # #       # - name: "Set up Python"
# # #       #   uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# # #       #   with:
# # #       #     python-version: "${{ matrix.python-version }}"
# # #       #     allow-prereleases: true
# # #           # At a certain point, installing dependencies failed on pypy 3.9 and
# # #           # 3.10 on Windows.  Commenting out the cache here fixed it.  Someday
# # #           # try using the cache again.
# # #           #cache: pip
# # #           #cache-dependency-path: 'requirements/*.pip'

# # #       # - name: "Show environment"
# # #       #   run: |
# # #       #     set -xe
# # #       #     python -VV
# # #       #     python -m site
# # #       #     # For extreme debugging:
# # #       #     # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# # #       #     env | sort
# # #       #     # Ideally, the system Python wouldn't have writable sitepackages so
# # #       #     # try to make it not writable.  We can't always always change the
# # #       #     # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# # #       #     chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# # #       #     ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# # #       #     whoami

# # #       - name: "Install dependencies"
# # #         run: |
# # #           set -xe
# # #           python${{ matrix.python-version }} -m pip install -r requirements/tox.pip

# # #       - name: "Run tox for ${{ matrix.python-version }}"
# # #         run: |
# # #           python${{ matrix.python-version }} -m tox -- -rfsEX

# # #       - name: "Retry tox for ${{ matrix.python-version }}"
# # #         if: failure()
# # #         run: |
# # #           # `exit 1` makes sure that the job remains red with flaky runs
# # #           python${{ matrix.python-version }} -m tox -- -rfsEX --lf -vvvvv && exit 1     
    
# # #     # steps:
# #     #   - name: "Check out the repo"
# #     #     uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# #     #     with:
# #     #       persist-credentials: false

# #       # - name: "Set up Python"
# #       #   uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# #       #   with:
# #       #     python-version: "${{ matrix.python-version }}"
# #       #     allow-prereleases: true
           
# #       # # - name: "Set up QEMU"
# #       # #   if: ${{ matrix.arch == 'ppc64le'  }}
# #       # #   uses: docker/setup-qemu-action@v3     

# #       # # - name: "Setup docker buildx" 
# #       # #   uses: docker/setup-buildx-action@v3 

# #       # #ppc64le/python:${{ matrix.python-version }}-slim \
# #       # - name: "Run test on ppc"
# #       #   run: |
# #       #       set -xe
# #       #       docker run --rm \
# #       #       --platform=linux/ppc64le \
# #       #       -v "$PWD:/work" \
# #       #       -w /work \
# #       #       ppc64le/python:${{ matrix.python-version }}-slim \
# #       #       bash -exec "
# #       #         apt update -y && apt install gcc git build-essential -y
# #       #         git config --global --add safe.directory /work
# #       #         git fetch origin main --depth=1
# #       #         python -m pip install -U pip setuptools wheel
# #       #         python -m pip install -r requirements/tox.pip 
# #       #         python -m tox -- -rfsEX
# #       #       " 
    











# # #####QEMU only python 3.10 is failing#########

# # # Licensed under the Apache License: http://www.apache.org/licenses/LICENSE-2.0
# # # For details: https://github.com/coveragepy/coveragepy/blob/main/NOTICE.txt

# # # name: "Tests"

# # # on:
# # #   push:
# # #     branches:
# # #       #- main
# # #       #- nedbat/*
# # #       - ppc_coverage
# # #   pull_request:
# # #   workflow_dispatch:

# # # defaults:
# # #   run:
# # #     shell: bash

# # # env:
# # #   PIP_DISABLE_PIP_VERSION_CHECK: 1
# # #   COVERAGE_IGOR_VERBOSE: 2
# # #   FORCE_COLOR: 1    # Get colored pytest output
# # #   HYPOTHESIS_PROFILE: ci

# # # permissions:
# # #   contents: read

# # # concurrency:
# # #   group: "${{ github.workflow }}-${{ github.ref }}"
# # #   cancel-in-progress: true

# # # jobs:
# # #   changed:
# # #     name: "Check changed files"
# # #     runs-on: ubuntu-latest
# # #     permissions:
# # #       pull-requests: read   # Needed for this check to run on pull requests
# # #     outputs:
# # #       run_tests: ${{ steps.filter.outputs.run_tests }}
# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false

# # #       - name: "Examine changed files"
# # #         uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36 # v3.0.2
# # #         id: filter
# # #         with:
# # #           filters: |
# # #             run_tests:
# # #               - "*.py"
# # #               - "coverage/**.py"
# # #               - "tests/**.py"
# # #               - "**.h"
# # #               - "**.c"
# # #               - ".github/workflows/testsuite.yml"
# # #               - "tox.ini"
# # #               - "requirements/*.pip"
# # #               - "tests/gold/**"

# # #   tests:
# # #     name: "${{ matrix.python-version }} on ${{ matrix.os }}"
# # #     runs-on: "${{ matrix.os }}-${{ matrix.os-version }}"
# # #     timeout-minutes: 10

# # #     # Don't run tests if the branch name includes "-notests".
# # #     # Only run tests if files that affect tests have changed.
# # #     needs: changed
# # #     if:
# # #       needs.changed.outputs.run_tests == 'true'
# # #       && !contains(github.ref, '-notests')

# # #     env:
# # #       TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

# # #     strategy:
# # #       matrix:
# # #         os:
# # #           - ubuntu
# # #           - macos
# # #           - windows
# # #         os-version:
# # #           - latest 
# # #         python-version:
# # #           # When changing this list, be sure to check the [gh] list in
# # #           # tox.ini so that tox will run properly. PYVERSIONS
# # #           # Available versions:
# # #           # https://github.com/actions/python-versions/blob/main/versions-manifest.json
# # #           # https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#available-versions-of-python-and-pypy
# # #           - "3.10"
# # #           - "3.11"
# # #           - "3.12"
# # #           - "3.13"
# # #           - "3.13t"
# # #           - "3.14"
# # #           - "3.14t"
# # #           - "3.15"
# # #           - "3.15t"
# # #           - "pypy-3.10"
# # #           - "pypy-3.11"
# # #         #
# # #         # If we need to exclude any combinations, do it like this:
# # #         #  exclude:
# # #         #    # Windows pypy 3.9 and 3.10 get stuck with PyPy 7.3.15.
# # #         #    - os: windows
# # #         #      python-version: "pypy-3.10"
# # #         #
# # #         # If we need to tweak the os version we can do it with an include like
# # #         # this:
# # #         #  include:
# # #         #    - python-version: "3.12"
# # #         #      os: "macos"
# # #         #      os-version: "15"

# # #       fail-fast: false

# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false

# # #       - name: "Set up Python"
# # #         uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# # #         with:
# # #           python-version: "${{ matrix.python-version }}"
# # #           allow-prereleases: true
# # #           # At a certain point, installing dependencies failed on pypy 3.9 and
# # #           # 3.10 on Windows.  Commenting out the cache here fixed it.  Someday
# # #           # try using the cache again.
# # #           #cache: pip
# # #           #cache-dependency-path: 'requirements/*.pip'

# # #       - name: "Show environment"
# # #         run: |
# # #           set -xe
# # #           python -VV
# # #           python -m site
# # #           # For extreme debugging:
# # #           # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# # #           env | sort
# # #           # Ideally, the system Python wouldn't have writable sitepackages so
# # #           # try to make it not writable.  We can't always always change the
# # #           # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# # #           chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# # #           ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# # #           whoami

# # #       - name: "Install dependencies"
# # #         run: |
# # #           set -xe
# # #           python -m pip install -r requirements/tox.pip

# # #       - name: "Run tox for ${{ matrix.python-version }}"
# # #         run: |
# # #           python -m tox -- -rfsEX

# # #       - name: "Retry tox for ${{ matrix.python-version }}"
# # #         if: failure()
# # #         run: |
# # #           # `exit 1` makes sure that the job remains red with flaky runs
# # #           python -m tox -- -rfsEX --lf -vvvvv && exit 1

# # #   tests-ppc64le:
# # #     name: "Tests on ppc64le (QEMU) ${{ matrix.python-version }}"
# # #     runs-on: ubuntu-latest
# # #     timeout-minutes: 70

# # #     needs: changed

# # #     strategy:
# # #       matrix:
# # #         python-version:
# # #           - "3.10"
# # #           - "3.11"
# # #           - "3.12"
# # #           - "3.13"
# # #        #   - "3.13t"
# # #           - "3.14"
# # #        #   - "3.14t"
# # #        #   - "3.15"
# # #        #  - "3.15t"
# # #        #   - "pypy-3.10"
# # #        #   - "pypy-3.11"
      
# # #         arch:
# # #           - ppc64le 
# # #       fail-fast: false    
    
# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false

# # #       # - name: "Set up Python"
# # #       #   uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# # #       #   with:
# # #       #     python-version: "${{ matrix.python-version }}"
# # #       #     allow-prereleases: true
           
# # #       - name: "Set up QEMU"
# # #         if: ${{ matrix.arch == 'ppc64le'  }}
# # #         uses: docker/setup-qemu-action@v3     

# # #       - name: "Setup docker buildx" 
# # #         uses: docker/setup-buildx-action@v3 

# # #       #ppc64le/python:${{ matrix.python-version }}-slim \
# # #       - name: "Run test on ppc"
# # #         run: |
# # #             set -xe
# # #             docker run --rm \
# # #             --platform=linux/ppc64le \
# # #             -v "$PWD:/work" \
# # #             -w /work \
# # #             ppc64le/python:${{ matrix.python-version }}-slim \
# # #             bash -exec "
# # #               apt update -y && apt install gcc git build-essential -y
# # #               git config --global --add safe.directory /work
# # #               git fetch origin main --depth=1
# # #               python -m pip install -U pip setuptools wheel
# # #               python -m pip install -r requirements/tox.pip 
# # #               python -m tox -- -rfsEX
# # #             " 
    
# #       # - name: "Show environment"
# #       #   run: |
# #       #     set -xe
# #       #     python -VV
# #       #     python -m site
# #       #     # For extreme debugging:
# #       #     # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# #       #     env | sort
# #       #     # Ideally, the system Python wouldn't have writable sitepackages so
# #       #     # try to make it not writable.  We can't always always change the
# #       #     # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# #       #     chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# #       #     ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# #       #     whoami

# #       # - name: "Install dependencies"
# #       #   run: |
# #       #     set -xe
# #       #     python -m pip install -r requirements/tox.pip

# #       # - name: "Run tox for ${{ matrix.python-version }}"
# #       #   run: |
# #       #     python -m tox -- -rfsEX

# #       # - name: "Retry tox for ${{ matrix.python-version }}"
# #       #   if: failure()
# #       #   run: |
# #       #     # `exit 1` makes sure that the job remains red with flaky runs
# #       #     python -m tox -- -rfsEX --lf -vvvvv && exit 1

# #   # This job aggregates test results. It's the required check for branch protection.
# #   # https://github.com/marketplace/actions/alls-green#why
# #   # https://github.com/orgs/community/discussions/33579
# #   # success:
# #   #   name: Tests successful
# #   #   needs:
# #   #     - tests
# #   #     - tests-ppc64le
# #   #   runs-on: ubuntu-latest
# #   #   steps:
# #   #     - name: Decide whether the needed jobs succeeded or failed
# #   #       uses: re-actors/alls-green@05ac9388f0aebcb5727afa17fcccfecd6f8ec5fe # v1.2.2
# #   #       with:
# #   #         jobs: ${{ toJSON(needs) }}




# # #WORKED BUT NOT COMPATIBLE FOR PPC

# # # # Licensed under the Apache License: http://www.apache.org/licenses/LICENSE-2.0
# # # # For details: https://github.com/coveragepy/coveragepy/blob/main/NOTICE.txt

# # # name: "Tests"

# # # on:
# # #   push:
# # #     branches:
# # #       #- main
# # #       #- nedbat/*
# # #       - ppc_coverage
# # #   pull_request:
# # #   workflow_dispatch:

# # # defaults:
# # #   run:
# # #     shell: bash

# # # env:
# # #   PIP_DISABLE_PIP_VERSION_CHECK: 1
# # #   COVERAGE_IGOR_VERBOSE: 2
# # #   FORCE_COLOR: 1    # Get colored pytest output
# # #   HYPOTHESIS_PROFILE: ci

# # # permissions:
# # #   contents: read

# # # concurrency:
# # #   group: "${{ github.workflow }}-${{ github.ref }}"
# # #   cancel-in-progress: true

# # # jobs:
# # #   changed:
# # #     name: "Check changed files"
# # #     runs-on: ubuntu-latest
# # #     permissions:
# # #       pull-requests: read   # Needed for this check to run on pull requests
# # #     outputs:
# # #       run_tests: ${{ steps.filter.outputs.run_tests }}
# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false

# # #       - name: "Examine changed files"
# # #         uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36 # v3.0.2
# # #         id: filter
# # #         with:
# # #           filters: |
# # #             run_tests:
# # #               - "*.py"
# # #               - "coverage/**.py"
# # #               - "tests/**.py"
# # #               - "**.h"
# # #               - "**.c"
# # #               - ".github/workflows/testsuite.yml"
# # #               - "tox.ini"
# # #               - "requirements/*.pip"
# # #               - "tests/gold/**"

# # #   tests:
# # #     name: "${{ matrix.python-version }} on ${{ matrix.arch }}"
# # #     runs-on: "${{ matrix.os }}-${{ matrix.os-version }}" #ubuntu-latest #"${{ matrix.os }}-${{ matrix.os-version }}"
# # #     #ubuntu-latest #"${{ matrix.os }}-${{ matrix.os-version }}"
# # #     timeout-minutes: 10

# # #     # Don't run tests if the branch name includes "-notests".
# # #     # Only run tests if files that affect tests have changed.
# # #     needs: changed
# # #     if:
# # #       needs.changed.outputs.run_tests == 'true'
# # #       && !contains(github.ref, '-notests')

# # #     env:
# # #       TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

# # #     strategy:
# # #       matrix:
# # #         os:
# # #           - ubuntu
# # #           - macos
# # #           - windows
# # #          # - ppc64le
# # #         os-version:
# # #           - latest
# # #         python-version:
# # #           # When changing this list, be sure to check the [gh] list in
# # #           # tox.ini so that tox will run properly. PYVERSIONS
# # #           # Available versions:
# # #           # https://github.com/actions/python-versions/blob/main/versions-manifest.json
# # #           # https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#available-versions-of-python-and-pypy
# # #           - "3.10"
# # #           - "3.11"
# # #           - "3.12"
# # #           - "3.13"
# # #           - "3.13t"
# # #           - "3.14"
# # #           - "3.14t"
# # #           - "3.15"
# # #           - "3.15t"
# # #           - "pypy-3.10"
# # #           - "pypy-3.11"
# # #         arch:
# # #           - macos
# # #           - windows
# # #           - ubuntu
# # #           - ppc64le 
# # #         #
# # #         # If we need to exclude any combinations, do it like this:
# # #         #  exclude:
# # #         #    # Windows pypy 3.9 and 3.10 get stuck with PyPy 7.3.15.
# # #         #    - os: windows
# # #         #      python-version: "pypy-3.10"
# # #         #
# # #         # If we need to tweak the os version we can do it with an include like
# # #         # this:
# # #         #  include:
# # #         #    - python-version: "3.12"
# # #         #      os: "macos"
# # #         #      os-version: "15"

# # #       fail-fast: false

# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false
      
# # #       - name: "Set up Python"
# # #         uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# # #         with:
# # #           python-version: "${{ matrix.python-version }}"
# # #           allow-prereleases: true
# # #           # At a certain point, installing dependencies failed on pypy 3.9 and
# # #           # 3.10 on Windows.  Commenting out the cache here fixed it.  Someday
# # #           # try using the cache again.
# # #           #cache: pip
# # #           #cache-dependency-path: 'requirements/*.pip'

# # #       - name: "Show environment"
# # #         run: |
# # #           set -xe
# # #           python -VV
# # #           python -m site
# # #           # For extreme debugging:
# # #           # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# # #           env | sort
# # #           # Ideally, the system Python wouldn't have writable sitepackages so
# # #           # try to make it not writable.  We can't always always change the
# # #           # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# # #           chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# # #           ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# # #           whoami

# # #       - name: "Install dependencies"
# # #         run: |
# # #           set -xe
# # #           python -m pip install -r requirements/tox.pip

# # #       - name: "Run tox for ${{ matrix.python-version }}"
# # #         run: |
# # #           python -m tox -- -rfsEX

# # #       - name: "Retry tox for ${{ matrix.python-version }}"
# # #         if: failure()
# # #         run: |
# # #           # `exit 1` makes sure that the job remains red with flaky runs
# # #           python -m tox -- -rfsEX --lf -vvvvv && exit 1

# # #       - name: "Set up QEMU"
# # #         if: ${{ matrix.os == 'ubuntu' && matrix.arch == 'ppc64le'  }}
# # #         uses: docker/setup-qemu-action@c7c53464625b32c7a7e944ae62b3e17d2b600130 # v3.7.0   

# # #   # This job aggregates test results. It's the required check for branch protection.
# # #   # https://github.com/marketplace/actions/alls-green#why
# # #   # https://github.com/orgs/community/discussions/33579
# # #   success:
# # #     name: Tests successful
# # #     needs:
# # #       - tests
# # #     runs-on: ubuntu-latest
# # #     steps:
# # #       - name: Decide whether the needed jobs succeeded or failed
# # #         uses: re-actors/alls-green@05ac9388f0aebcb5727afa17fcccfecd6f8ec5fe # v1.2.2
# # #         with:
# # #           jobs: ${{ toJSON(needs) }}













# # # # Licensed under the Apache License: http://www.apache.org/licenses/LICENSE-2.0
# # # # For details: https://github.com/coveragepy/coveragepy/blob/main/NOTICE.txt

# # # name: "Tests"

# # # on:
# # #   push:
# # #     branches:
# # #       #- main
# # #       #- nedbat/*
# # #       - ppc_coverage
# # #   pull_request:
# # #   workflow_dispatch:

# # # defaults:
# # #   run:
# # #     shell: bash

# # # env:
# # #   PIP_DISABLE_PIP_VERSION_CHECK: 1
# # #   COVERAGE_IGOR_VERBOSE: 2
# # #   FORCE_COLOR: 1    # Get colored pytest output
# # #   HYPOTHESIS_PROFILE: ci

# # # permissions:
# # #   contents: read

# # # concurrency:
# # #   group: "${{ github.workflow }}-${{ github.ref }}"
# # #   cancel-in-progress: true

# # # jobs:
# # #   changed:
# # #     name: "Check changed files"
# # #     runs-on: self-hosted #ubuntu-latest  ->not needed
# # #     permissions:
# # #       pull-requests: read   # Needed for this check to run on pull requests
# # #     outputs:
# # #       run_tests: ${{ steps.filter.outputs.run_tests }}
# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false

# # #       - name: "Examine changed files"
# # #         uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36 # v3.0.2
# # #         id: filter
# # #         with:
# # #           filters: |
# # #             run_tests:
# # #               - "*.py"
# # #               - "coverage/**.py"
# # #               - "tests/**.py"
# # #               - "**.h"
# # #               - "**.c"
# # #               - ".github/workflows/testsuite.yml"
# # #               - "tox.ini"
# # #               - "requirements/*.pip"
# # #               - "tests/gold/**"

# # #       - name: "Install dependencies"
# # #         run: |
# # #           sudo apt update
# # #           sudo apt install -y python3 python3-pip python3-dev python3-venv
# # #           python3 -m pip install --upgrade pip
# # #           python3 -m pip install cibuildwheel tox          

# # #   tests:
# # #     name: "${{ matrix.python-version }} on ${{ matrix.os }}"
# # #     runs-on: self-hosted #"${{ matrix.os }}-${{ matrix.os-version }}"   ### check with qemu once
# # #     timeout-minutes: 10

# # #     # Don't run tests if the branch name includes "-notests".
# # #     # Only run tests if files that affect tests have changed.
# # #     needs: changed
# # #     if:
# # #       needs.changed.outputs.run_tests == 'true'
# # #       && !contains(github.ref, '-notests')

# # #     env:
# # #       TOX_GH_MAJOR_MINOR: "${{ matrix.python-version }}"

# # #     strategy:
# # #       matrix:
# # #         os:
# # #          # - ubuntu
# # #          # - macos
# # #          # - windows
# # #           - ppc64le
# # #         os-version:
# # #           - latest
# # #         python-version:
# # #           # When changing this list, be sure to check the [gh] list in
# # #           # tox.ini so that tox will run properly. PYVERSIONS
# # #           # Available versions:
# # #           # https://github.com/actions/python-versions/blob/main/versions-manifest.json
# # #           # https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#available-versions-of-python-and-pypy
# # #          # - "3.10"
# # #           - "3.11"
# # #           - "3.12"
# # #          # - "3.13"
# # #          # - "3.13t"
# # #          # - "3.14"
# # #          # - "3.14t"
# # #          # - "3.15"
# # #          # - "3.15t"
# # #           #- "pypy-3.10"
# # #           #- "pypy-3.11"
# # #         #
# # #         # If we need to exclude any combinations, do it like this:
# # #         #  exclude:
# # #         #    # Windows pypy 3.9 and 3.10 get stuck with PyPy 7.3.15.
# # #         #    - os: windows
# # #         #      python-version: "pypy-3.10"
# # #         #
# # #         # If we need to tweak the os version we can do it with an include like
# # #         # this:
# # #         #  include:
# # #         #    - python-version: "3.12"
# # #         #      os: "macos"
# # #         #      os-version: "15"

# # #       fail-fast: false

# # #     steps:
# # #       - name: "Check out the repo"
# # #         uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6.0.1
# # #         with:
# # #           persist-credentials: false


# # #       - name: "Install dependencies"
# # #         run: |
# # #           sudo apt update -y
# # #           sudo apt install -y python${{matrix.python-version}}
# # #           python${{matrix.python-version}} -m pip install --upgrade pip
# # #           python${{matrix.python-version}} -m pip install cibuildwheel tox 

# # #       # - name: "Set up Python"
# # #       #   uses: actions/setup-python@83679a892e2d95755f2dac6acb0bfd1e9ac5d548 # v6.1.0
# # #       #   with:
# # #       #     python-version: "${{ matrix.python-version }}"
# # #       #     allow-prereleases: true
# # #           # At a certain point, installing dependencies failed on pypy 3.9 and
# # #           # 3.10 on Windows.  Commenting out the cache here fixed it.  Someday
# # #           # try using the cache again.
# # #           #cache: pip
# # #           #cache-dependency-path: 'requirements/*.pip'

# # #       - name: "Show environment"
# # #         run: |
# # #           set -xe
# # #           python -VV
# # #           python -m site
# # #           # For extreme debugging:
# # #           # python -c "import urllib.request as r; exec(r.urlopen('https://bit.ly/pydoctor').read())"
# # #           env | sort
# # #           # Ideally, the system Python wouldn't have writable sitepackages so
# # #           # try to make it not writable.  We can't always always change the
# # #           # permissions (Ubuntu & Windows yes, Mac no), so be ready for it to fail.
# # #           chmod u-w $(python -c "import site; print(site.getsitepackages()[0])") || echo "Couldn't lock down site-packages"
# # #           ls -ld $(python -c "import site; print(site.getsitepackages()[0])")
# # #           whoami

# # #       - name: "Install dependencies"
# # #         run: |
# # #           set -xe
# # #           python -m pip install -r requirements/tox.pip

# # #       - name: "Run tox for ${{ matrix.python-version }}"
# # #         run: |
# # #           python -m tox -- -rfsEX

# # #       - name: "Retry tox for ${{ matrix.python-version }}"
# # #         if: failure()
# # #         run: |
# # #           # `exit 1` makes sure that the job remains red with flaky runs
# # #           python -m tox -- -rfsEX --lf -vvvvv && exit 1

# # #   # This job aggregates test results. It's the required check for branch protection.
# # #   # https://github.com/marketplace/actions/alls-green#why
# # #   # https://github.com/orgs/community/discussions/33579
# # #   success:
# # #     name: Tests successful
# # #     needs:
# # #       - tests
# # #     runs-on: ubuntu-latest
# # #     steps:
# # #       - name: Decide whether the needed jobs succeeded or failed
# # #         uses: re-actors/alls-green@05ac9388f0aebcb5727afa17fcccfecd6f8ec5fe # v1.2.2
# # #         with:
# # #           jobs: ${{ toJSON(needs) }}
